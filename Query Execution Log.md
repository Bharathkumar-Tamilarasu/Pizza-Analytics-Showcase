# Pizza Analytics Showcase

## Query Execution Log

**Author**: Bharathkumar Tamilarasu <br />
**Email**: bharathkumar.t.17@gmail.com <br />
**Website**: https://bharathkumart17.wixsite.com/portfolio <br />
**LinkedIn**: https://www.linkedin.com/in/bharathkumar-tamilarasu-218429222/  <br />
##
	
### A.	KPIâ€™s

#### I.	Total Revenue

````sql
SELECT SUM(TOTAL_PRICE) AS TOTAL_REVENUE
FROM PIZZA_SALES
````

**Results:**


#### II. Average Order Value

````sql
SELECT SUM(TOTAL_PRICE) / COUNT(DISTINCT ORDER_ID) AS AVERAGE_ORDER_VALUE
FROM PIZZA_SALES
````

#### III. Total Pizzas Sold

````sql
SELECT SUM(QUANTITY) AS TOTAL_PIZZAS_SOLD
FROM PIZZA_SALES
````

#### IV. Total Orders

````sql
SELECT COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDERS
FROM PIZZA_SALES
````
 

#### V.	Average Pizzas Per Order

````sql
SELECT ROUND((SUM(QUANTITY) * 1.0) / (COUNT(DISTINCT ORDER_ID) * 1.0),2) AS AVERAGE_PIZZAS_PER_ORDER
FROM PIZZA_SALES
````
 
### B.	Hourly Trend for Total Pizzas Sold

````sql
SELECT EXTRACT(HOUR FROM ORDER_TIME) AS ORDER_TIME,SUM(QUANTITY) AS TOTAL_ORDERS
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 1
````
 

### C.	Weekly Trend for Total Orders

````sql
SELECT EXTRACT(WEEK FROM ORDER_DATE) AS WEEK_NUMBER,
	EXTRACT(YEAR FROM ORDER_DATE) AS ORDER_YEAR,
	COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDERS
FROM PIZZA_SALES
GROUP BY 1,2
ORDER BY 1
````

	
   
 

### D.	Percentage of Sales by Pizza Category

````sql
SELECT PIZZA_CATEGORY,
	CAST(SUM(TOTAL_PRICE) AS DECIMAL(10,2)) AS TOTAL_SALES,
	CAST((SUM(TOTAL_PRICE) * 100.0 / (SELECT SUM(TOTAL_PRICE) FROM PIZZA_SALES)) AS DECIMAL(10,2))
		AS PERCENTAGE_OF_TOTAL_SALES
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 1
````

 

### E.	Percentage of Sales by Pizza Size

````sql
SELECT PIZZA_SIZE,
	CAST(SUM(TOTAL_PRICE) AS DECIMAL(10,2)) AS TOTAL_SALES,
	CAST((SUM(TOTAL_PRICE) * 100 /(SELECT SUM(TOTAL_PRICE)FROM PIZZA_SALES)) AS DECIMAL(10,2))
		AS PERCENTAGE_OF_TOTAL_SALES
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 3 DESC
````
 

### F.	Total Pizzas Sold by Pizza Category

````sql
SELECT PIZZA_CATEGORY,
	SUM(QUANTITY) AS TOTAL_SALES
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 DESC
````

 

### G.	Top 5 Best Sellers by Revenue, Total Quantity and Total Orders

#### I.	By Revenue

````sql
SELECT PIZZA_NAME,
	SUM(TOTAL_PRICE) AS TOTAL_REVENUE
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5
````

 

#### II. By Total Quantity

````sql
SELECT PIZZA_NAME,
	SUM(QUANTITY) AS TOTAL_QUANTITY
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5
````
 

#### III. Total Orders

````sql
SELECT PIZZA_NAME,
	COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDERS
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5
````
 

### H.	Bottom 5 Best Sellers by Revenue, Total Quantity and Total Orders

#### I.	By Revenue

````sql
SELECT PIZZA_NAME,
	SUM(TOTAL_PRICE) AS TOTAL_REVENUE
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 ASC
LIMIT 5
````
 

#### II. By Total Quantity

````sql
SELECT PIZZA_NAME,
	SUM(QUANTITY) AS TOTAL_QUANTITY
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 ASC
LIMIT 5
````

 

#### III. Total Orders


````sql
SELECT PIZZA_NAME,
	COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDERS
FROM PIZZA_SALES
GROUP BY 1
ORDER BY 2 ASC
LIMIT 5
````



